{% extends 'index/base.html' %}
{% load staticfiles %}
{% load el_pagination_tags %}

{% block body %}
<style>

.endless_page_link{
    font-size:15px;
    background-color: rgb(238, 40, 124);
    color:white;
    padding: 3px 8px;
    border-radius:5px;
}
/*body {*/
/*  font: 16px Arial;*/
/*}*/

/*the container must be positioned relative:*/
.autocomplete {
  position: relative;
  display: inline-block;
}

input {
  border: 1px solid transparent;
  background-color: #f1f1f1;
  padding: 10px;
  font-size: 16px;
}

input[type=text] {
  background-color: #f1f1f1;
  width: 100%;
}

input[type=submit] {
  background-color: DodgerBlue;
  color: #fff;
  cursor: pointer;
}

.autocomplete-items {
  position: absolute;
  border: 1px solid #d4d4d4;
  border-bottom: none;
  border-top: none;
  z-index: 99;
  /*position the autocomplete items to be the same width as the container:*/
  top: 100%;
  left: 0;
  right: 0;
}

.autocomplete-items div {
  padding: 10px;
  cursor: pointer;
  background-color: #fff;
  border-bottom: 1px solid #d4d4d4;
}

/*when hovering an item:*/
.autocomplete-items div:hover {
  background-color: #e9e9e9;
}

/*when navigating through the items using the arrow keys:*/
.autocomplete-active {
  background-color: DodgerBlue !important;
  color: #ffffff;
}
</style>



<form action="{% url 'home:filter_search' %}" method="post"> {% csrf_token %}


<div class='container'>
    <div class='row' style='margin-top:85px;'>
        <div class='col-md-9'>
            <!-- A grey horizontal navbar that becomes vertical on small screens -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light" style='border-top: 1px solid lightgray; border-bottom: 1px solid lightgray; '>
        <div id="navbarNavDropdown" class="navbar-collapse collapse">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="#"><i class='fa fa-list-alt'></i> List <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'home:mapview_search' %}"><i class='fa fa-globe'></i> Map</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-toggle="modal" data-target="#myModal"><i class='fa fa-save'></i><span id='savesearchid'>Save Search</span></a>
                </li>


            </ul>
            <ul class="navbar-nav">

                <li class="nav-item">
                    <div class="form-group" style='margin-top:25px;'>
                    <label class="d-inline-block" for="">Sort By:</label>
                    <select class="form-control form-control-sm d-inline-block" style="width: auto;" id="sortby" name='sortby' onchange="this.form.submit()">
                    <option value="Relevant">Most Relevant</option>
                    <option value="-created">Date (Newest - Oldest)</option>
                    <option value="created">Date (Oldest - Newest)</option>
                    <option value="Price">Price (Lowest - Highest)</option>
                    <option value="-Price">Price (Highest - Lowest)</option>
                    </select>
                    </div>
                </li>

            </ul>
        </div>
    </nav>

<div class='row'>
    <div class='col-md-12'>
        <div id="searchitem" style=""></div>
    </div>
</div>


  <!-- The Modal -->
  <div class="modal fade" id="myModal">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">

        <!-- Modal Header -->
        <div class="modal-header">
          <h4 class="modal-title">Save Search</h4>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>

        <!-- Modal body -->
        <div class="modal-body">
            <div class="form-group">
            <label for="usr">Name the search:</label>
            <input type="text" class="form-control" id="namesave">
            </div>


        <div class="form-check">
        <label class="form-check-label">
        <input type="checkbox" class="form-check-input" id='checkboxsave' value=""> Enable Notifications
        </label>
        </div>

        </div>

        <!-- Modal footer -->
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <button type="button" class="btn btn-success" data-dismiss="modal" onclick='saveFunction()'>Submit</button>

        </div>

      </div>
    </div>
  </div>




    <hr>
{% paginate pagin %}
{% show_pages %}
<hr>
{% for i in pagin %}
    <div class="card" style='margin-bottom:20px;'>
        <div class="card-body">
            <h4 class="card-title"> <p>{{i.street_name}} {{i.street_number}} {{i.state}} {{i.suburb}}</p></h4>
            <p class="card-text">

            <div class='row'>
            <div class='col-md-4'>
              <a href='{% url 'home:details' i.id_user category1 %}'>   <img class='img-fluid' src={{i.image.url}}> </a>

            </div>
            <div class='col-md-8'>

            <div class='row'>
           <div class='col-md-12' style='background-color:rgb(238, 40, 124); color: white; padding: 8px 8px;'>
                <i class='fa fa-bed' style='color:white'></i> {{i.Bedrooms}} &nbsp&nbsp&nbsp
                <i class='fa fa-bath' style='color:white'></i> {{i.Bathrooms}} &nbsp&nbsp&nbsp
                <i class='fa fa-car' style='color:white'></i> {{i.Car_spaces}} &nbsp&nbsp&nbsp
                {% for a in saved %}
                {% if a.post_id == i.post_id %}
                <i class='fa fa-star' id='star{{i.id}}' style='color:white; float:right; cursor:pointer' onclick=StarSearch("{{i.id}}")></i>
                {% endif %}
                {% endfor %}
                <i class='fa fa-star' id='star{{i.id}}' style='color:white; float:right; cursor:pointer' onclick=StarSearch("{{i.id}}")></i>

            </div>
            </div>
            <hr>

                {{i.created|timesince}} ago <br> <br>
              {{i.Property_type}} | ${{i.Price}}  |  <a href='{% url 'home:details' i.id_user category1 %}'>See more</a>  <br>

              <br>
            </div>

            </div>
            <!--row-->
            <hr>
            </p>
        </div>
</div>
<!--end card-->


{% endfor %}
{% show_pages %}

        </div>
        <!--col-md-8-->

        <div class='col-md-3'>
                <div class="alert alert-danger" style='background-color: rgb(238, 40, 124); color:white;'>
                <strong> <i class='fa fa-filter'></i> Advance Filter Options ( <span id='filtercount'></span> )</strong>
                </div>

<div class="form-group row">

<div class='col-md-12'>
<input type="text" name="hiddensearch" id="hiddensearch" style="display: none;" value="">
<input type="text" name="category" id="category" style="display: none;" value="Poster">
<input type="text" name="filterlist" id="filterlist" style="display: none;" value="">

<input type="text" name="propertytype1" id="propertytype1" style="display: none;" value="All property types">
<input type='text' class='form-control' id="myInput" name="myCountry" oninput="InputChange()">

</div>

<div class="col-sm-6">
<label for="pricemin"><small>Price (Min):</small></label>
    <select class="custom-select custom-select-sm" id="pricemin" name="pricemin" >
    <option>Any </option>
    <option>$50,000 </option>
    <option>$75,000</option>
    <option>$100,000</option>
    <option>$125,000</option>
    <option>$150,000</option>
    <option>$175,000</option>
    <option>$200,000</option>
    <option>$225,000</option>
    <option>$250,000</option>
    <option>$275,000</option>
    <option>$300,000</option>
    <option>$325,000</option>
    <option>$350,000</option>
    <option>$350,000</option>
    <option>$350,000</option>
    <option>$375,000</option>
    <option>$400,000</option>
    <option>$425,000</option>
    <option>$450,000</option>
    <option>$475,000</option>
    <option>$500,000</option>
    <option>$550,000</option>
    <option>$600,000</option>
    <option>$650,000</option>
    <option>$700,000</option>
    <option>$750,000</option>
    <option>$800,000</option>
    <option>$850,000</option>
    <option>$900,000</option>
    <option>$950,000</option>
    <option>$1,000,000</option>
    <option>$1,100,000</option>
    <option>$1,200,000</option>
    <option>$1,300,000</option>
    <option>$1,400,000</option>
    <option>$1,500,000</option>
    <option>$1,600,000</option>
    <option>$1,700,000</option>
    <option>$1,800,000</option>
    <option>$1,900,000</option>
    <option>$2,000,000</option>
    <option>$2,250,000</option>
    <option>$2,500,000</option>
    <option>$2,750,000</option>
    <option>$3,000,000</option>
    <option>$3,500,000</option>
    <option>$4,000,000</option>
    <option>$4,500,000</option>
    <option>$5,000,000 </option>
    <option>$7,000,000</option>
    <option>$8,000,000</option>
    <option>$9,000,000</option>
    <option>$10,000,000</option>
    <option>$12,000,000</option>
    <option>$15,000,000</option>

    </select>

</div>

<div class="col-sm-6">
<label for="pricemax"><small>Price (Max):</small></label>
<select class="custom-select custom-select-sm" id="pricemax" name="pricemax" >
<option>Any </option>
<option>$50,000 </option>
<option>$75,000</option>
<option>$100,000</option>
<option>$125,000</option>
<option>$150,000</option>
<option>$175,000</option>
<option>$200,000</option>
<option>$225,000</option>
<option>$250,000</option>
<option>$275,000</option>
<option>$300,000</option>
<option>$325,000</option>
<option>$350,000</option>
<option>$350,000</option>
<option>$350,000</option>
<option>$375,000</option>
<option>$400,000</option>
<option>$425,000</option>
<option>$450,000</option>
<option>$475,000</option>
<option>$500,000</option>
<option>$550,000</option>
<option>$600,000</option>
<option>$650,000</option>
<option>$700,000</option>
<option>$750,000</option>
<option>$800,000</option>
<option>$850,000</option>
<option>$900,000</option>
<option>$950,000</option>
<option>$1,000,000</option>
<option>$1,100,000</option>
<option>$1,200,000</option>
<option>$1,300,000</option>
<option>$1,400,000</option>
<option>$1,500,000</option>
<option>$1,600,000</option>
<option>$1,700,000</option>
<option>$1,800,000</option>
<option>$1,900,000</option>
<option>$2,000,000</option>
<option>$2,250,000</option>
<option>$2,500,000</option>
<option>$2,750,000</option>
<option>$3,000,000</option>
<option>$3,500,000</option>
<option>$4,000,000</option>
<option>$4,500,000</option>
<option>$5,000,000 </option>
<option>$7,000,000</option>
<option>$8,000,000</option>
<option>$9,000,000</option>
<option>$10,000,000</option>
<option>$12,000,000</option>
<option>$15,000,000</option>

</select>
</div>
<!--col-md-6-->


<div class='col-md-6'>
<label for="bedmin"> <small>Bed (Min):</small></label>
<select class="custom-select custom-select-sm" id="bedmin" name="Bed(min)" >
<option>Any</option>
<option>Studio</option>
<option value="1">1</option>
<option value="2">2</option>
<option value="3">3</option>
<option value="4">4</option>
<option value="5">5</option>
</select>
</div>

<div class='col-md-6'>
<label for="bedmax"> <small>Bed (Max):</small></label>
<select class="custom-select custom-select-sm" id="bedmax" name="Bed(max)" >
<option value='Any'>Any</option>
<option value='Studio'>Studio</option>
<option value="1">1</option>
<option value="2">2</option>
<option value="3">3</option>
<option value="4">4</option>
<option value="5">5</option>
</select>
</div>

<!--<div class='col-md-6'>-->
<!--    <button data-toggle="collapse" data-target="#demo" class='btn btn-default btn-block btn-sm' style='background-color: rgb(238, 40, 124); color:white; margin-top:7px; cursor:pointer' >Property Type</button>-->
<!--</div>-->
<!--<div class='col-md-6'>-->
<!--    <button data-toggle="collapse" data-target="#filter" class='btn btn-default btn-block btn-sm' style='background-color: rgb(238, 40, 124); color:white; margin-top:7px; cursor:pointer' ><i style='color:white' class='fa fa-filter'> </i> Filter ( <span id='filtercount'></span>)</button>-->
<!--</div>-->

<!--<div class='col-md-12'>-->
<!--    <button type='submit' class='btn btn-default btn-block btn-sm' style='background-color: rgb(238, 40, 124); color:white; margin-top:7px; cursor:pointer' >Submit</button>-->
<!--</div>-->


<div class='col-md-12'>
<div id="filter" class="">
    <h6>Filter Items</h6>
    <div class='form-group row'>
<div class='col-md-6'>
<label for=""> <small>Bathrooms:</small></label>
<select class="custom-select custom-select-sm" id="" name="" >
<option>Any</option>
<option>Studio</option>
<option value="1">1</option>
<option value="2">2</option>
<option value="3">3</option>
<option value="4">4</option>
<option value="5">5</option>
</select>
</div>

<div class='col-md-6'>
<label for=""> <small>Car Spaces:</small></label>
<select class="custom-select custom-select-sm" id="" name="" >
<option>Any</option>
<option>Studio</option>
<option value="1">1</option>
<option value="2">2</option>
<option value="3">3</option>
<option value="4">4</option>
<option value="5">5</option>
</select>
</div>
<div class='col-md-6'>
<label for=""> <small>Min land size (m2):</small></label>
<select class="custom-select custom-select-sm" id="bedmin" name="" >
<option>Any</option>
<option>Studio</option>
<option value="100">100</option>
<option value="200">200</option>
<option value="300">300</option>
<option value="400">400</option>
<option value="500">500</option>
</select>
</div>

<div class='col-md-6'>
<label for=""> <small>New or established:</small></label>
<select class="custom-select custom-select-sm" id="" name="" >
<option value='Any'>Any</option>
<option value='New'>New</option>
<option value="Established">Established</option>
</select>
</div>
<hr>

<div class='col-md-12'><br>
<center><b>Outdoor Features</b></center>
<hr>
</div>

</div>

    <div class="form-check-inline">
      <label class="form-check-label">
        <input type="checkbox" class="form-check-input" value='Swimming_pool' onclick=changeFilter(this)> Swimming pool
      </label>
    </div>
    <div class="form-check-inline">
      <label class="form-check-label">
        <input type="checkbox" class="form-check-input" value='Balcony' onclick=changeFilter(this)> Balcony
      </label>
    </div>
    <hr>
  <div class="form-check-inline">
      <label class="form-check-label" for="check1">
        <input type="checkbox" class="form-check-input" id="check1"  value="Garage" onclick=changeFilter(this)> Garage
      </label>
    </div>
    <div class="form-check-inline">
      <label class="form-check-label" for="check2">
        <input type="checkbox" class="form-check-input" id="check2" value="Outdoor_area" onclick=changeFilter(this)> Outdoor area
      </label>
    </div>

    <hr>
    <div class="form-check-inline">
      <label class="form-check-label" for="check1">
        <input type="checkbox" class="form-check-input" id="check1"  value="Fully_fenced" onclick=changeFilter(this) > Fully fenced
      </label>
    </div>
    <div class="form-check-inline">
      <label class="form-check-label" for="check2">
        <input type="checkbox" class="form-check-input" id="check2" value="Shed" onclick=changeFilter(this)> Shed
      </label>
    </div>
    <hr>
    <div class="form-check-inline">
      <label class="form-check-label">
        <input type="checkbox" class="form-check-input" value='Outdoor_spa' onclick=changeFilter(this)> Outdoor spa
      </label>
    </div>
  <div class="form-check-inline">
      <label class="form-check-label">
        <input type="checkbox" class="form-check-input" value='Tennis_court' onclick=changeFilter(this)> Tennis court
      </label>
    </div>
    <hr>
 <div class="form-check-inline">
      <label class="form-check-label">
        <input type="checkbox" class="form-check-input" value='Undercover_parking' onclick=changeFilter(this)> Undercover parking
      </label>
    </div>

<div class='col-md-12'><br>
<center><b>Indoor Features</b></center>
<hr>
</div>


<div class="form-check-inline">
<label class="form-check-label" for="check1">
<input type="checkbox" class="form-check-input" value="Ensuite" onclick=changeFilter(this) > Ensuite
</label>
</div>
<div class="form-check-inline">
<label class="form-check-label" for="check2">
<input type="checkbox" class="form-check-input"  value="DishWasher" onclick=changeFilter(this)> Dishwasher
</label>
</div>
<hr>
<div class="form-check-inline">
<label class="form-check-label">
<input type="checkbox" class="form-check-input" value='Built_in_robes' onclick=changeFilter(this)> Built in robes
</label>
</div>
<div class="form-check-inline">
<label class="form-check-label">
<input type="checkbox" class="form-check-input" value='Study' onclick=changeFilter(this)> Study
</label>
</div>
<hr>
<div class="form-check-inline">
<label class="form-check-label">
<input type="checkbox" class="form-check-input" value='Alarm_system' onclick=changeFilter(this)> Alarm system
</label>
</div>
<div class="form-check-inline">
<label class="form-check-label">
<input type="checkbox" class="form-check-input" value='Broadband' onclick=changeFilter(this)> Broadband
</label>
</div>
<hr>
<div class="form-check-inline">
<label class="form-check-label">
<input type="checkbox" class="form-check-input" value='Floorboards' onclick=changeFilter(this)> Floorboards
</label>
</div>
<div class="form-check-inline">
<label class="form-check-label">
<input type="checkbox" class="form-check-input" value='Gym' onclick=changeFilter(this)> Gym
</label>
</div>
<hr>
<div class="form-check-inline">
<label class="form-check-label">
<input type="checkbox" class="form-check-input" value='Rumpus_room' onclick=changeFilter(this)> Rumpus room
</label>
</div>
<div class="form-check-inline">
<label class="form-check-label">
<input type="checkbox" class="form-check-input" value='Workshop' onclick=changeFilter(this)> Workshop
</label>
</div>
<hr>
<div class='col-md-12'><br>
<center><b>Climate control & energy</b></center>
<hr>
</div>


<div class="form-check-inline">
<label class="form-check-label" for="check1">
<input type="checkbox" class="form-check-input" value="Air_conditioning" onclick=changeFilter(this) > Air conditioning
</label>
</div>
<div class="form-check-inline">
<label class="form-check-label" for="check2">
<input type="checkbox" class="form-check-input"  value="Solar_panels" onclick=changeFilter(this)> Solar panels
</label>
</div>
<hr>
<div class="form-check-inline">
<label class="form-check-label">
<input type="checkbox" class="form-check-input" value='Heating' onclick=changeFilter(this)> Heating
</label>
</div>

<div class="form-check-inline">
<label class="form-check-label">
<input type="checkbox" class="form-check-input" value='Water_tank' onclick=changeFilter(this)> Water tank
</label>
</div>
<hr>
<div class="form-check-inline">
<label class="form-check-label">
<input type="checkbox" class="form-check-input" value='Solar_hot_water' onclick=changeFilter(this)> Solar hot water
</label>
</div>
<div class="form-check-inline">
<label class="form-check-label">
<input type="checkbox" class="form-check-input" value='High_energy_efficiency' onclick=changeFilter(this)> High energy efficiency
</label>
</div>
<hr>

<!--<div class='col-md-12'>-->
<!--    <button type='submit' class='btn btn-default btn-block btn-sm' style='background-color: rgb(238, 40, 124); color:white; margin-top:7px; cursor:pointer' >Submit</button>-->
<!--</div>-->

</div>
</div>
<div class='col-md-12'>
<div id="demo" class="">
    <div class="form-check-inline">
      <label class="form-check-label" for="check1">
        <input type="checkbox" class="form-check-input" id="All" value="All property types" onclick='changePropertyType(this.id)'>All property types
      </label>
    </div>
    <div class="form-check-inline">
      <label class="form-check-label" for="check2">
        <input type="checkbox" class="form-check-input" id="House" value="House" onclick='changePropertyType(this.id)'>House
      </label>
    </div>
    <hr>
    <div class="form-check-inline">
      <label class="form-check-label">
        <input type="checkbox" class="form-check-input"  id="Apartment"  value='Apartment & Unit' onclick='changePropertyType(this.id)'>Apartment & Unit
      </label>
    </div>
    <div class="form-check-inline">
      <label class="form-check-label">
        <input type="checkbox" class="form-check-input" id="Land" value='Land' onclick='changePropertyType(this.id)'>Land
      </label>
    </div>
    <hr>
  <div class="form-check-inline">
      <label class="form-check-label" for="check1">
        <input type="checkbox" class="form-check-input" id="Town" value="Town House" onclick='changePropertyType(this.id)'>Town House
      </label>
    </div>
    <div class="form-check-inline">
      <label class="form-check-label" for="check2">
        <input type="checkbox" class="form-check-input" id="Villa" value="Villa" onclick='changePropertyType(this.id)'> Villa
      </label>
    </div>

    <hr>
    <div class="form-check-inline">
      <label class="form-check-label" for="check1">
        <input type="checkbox" class="form-check-input" id="Acreage" value="Acreage" onclick='changePropertyType(this.id)'>Acreage
      </label>
    </div>
    <div class="form-check-inline">
      <label class="form-check-label" for="check2">
        <input type="checkbox" class="form-check-input" id="Rural" value="Rural" onclick='changePropertyType(this.id)'>Rural
      </label>
    </div>
    <hr>
    <div class="form-check-inline">
      <label class="form-check-label">
        <input type="checkbox" class="form-check-input" value='Block Of Units' id='Block' onclick='changePropertyType(this.id)'>Block Of Units
      </label>
    </div>
  <div class="form-check-inline">
      <label class="form-check-label">
        <input type="checkbox" class="form-check-input" value='Retirement Living' id='Retirement' onclick='changePropertyType(this.id)'>Retirement Living
      </label>
    </div>



<div class='col-md-12'>
    <button type='submit' class='btn btn-default btn-block btn-sm' style='background-color: rgb(238, 40, 124); color:white; margin-top:7px; cursor:pointer' >Submit</button>
</div>
</form>

</div>



</div>






</div>
<!--form group row-->







        </div>
        <!--col-md-4-->


    </div>
</div>










<script>



sort = '{{sort|safe}}'
console.log('sorrrrrr', sort)
if (sort == '-Price'){
 document.getElementById("sortby").options.selectedIndex = 4;
}
else if(sort == 'Price'){
  document.getElementById("sortby").options.selectedIndex = 3;
}
else if(sort == 'created'){
  document.getElementById("sortby").options.selectedIndex = 2;
}
else if(sort == '-created'){
  document.getElementById("sortby").options.selectedIndex = 1;
}
else if(sort == 'Relevant'){
  document.getElementById("sortby").options.selectedIndex = 0;
}
else{
   document.getElementById("sortby").options.selectedIndex = 0;
}







var searchlist = []

filterlist = []


function saveFunction(){
    qs = document.querySelector('#savesearchid').innerHTML = 'loading'
    document.querySelector('#savesearchid').style.color = 'green'

    pricemin = document.querySelector('#pricemin').value
    pricemax = document.querySelector('#pricemin').value
    bedmin = document.querySelector('#bedmin').value
    bedmax = document.querySelector('#bedmax').value
    namesave = document.querySelector('#namesave').value
    propertytype = document.querySelector('#propertytype1').value
    console.log(propertytype, 'yaaaa')

    notification = document.querySelector('#checkboxsave').checked


            var token = document.querySelector("input[name=csrfmiddlewaretoken]").value

            var url = 'http://anandrathi.pythonanywhere.com/save_search_details/'
            let  formData = new FormData()
            formData.append('pricemin', pricemin)
            formData.append('pricemax', pricemax)
            formData.append('bedmin', bedmin)
            formData.append('bedmax', bedmax)
            formData.append('namesave', namesave)
            formData.append('notification', notification)
            formData.append('searchlist', searchlist)
            formData.append('propertytype', propertytype)


            fetch(url,
            {
            body: new URLSearchParams(formData),
            method: 'post',
            headers:{
            'X-CSRFTOKEN': token
            }


            }).then(res => res.json()).then(function(data) {

            console.log(data)
    qs = document.querySelector('#savesearchid').innerHTML = 'saved'
    document.querySelector('#savesearchid').style.color = 'pink'

            })

    // console.log('yeahhh', pricemin,pricemax, bedmin,bedmax, namesave , checkboxsave, searchlist )
}




function changeFilter(x){
    filtercount = document.querySelector('#filtercount').innerHTML
    position = filterlist.indexOf(x.value)
    console.log(position)
    if (x.checked == true){
        if(position == -1){
            console.log('uaaa')
            filterlist.push(x.value)
            document.querySelector('#filtercount').innerHTML = filterlist.length
            document.querySelector('#filterlist').value = filterlist

            console.log(filterlist, document.querySelector('#filterlist').value)
        }
    }
    else if(x.checked == false){
        if(position != -1){
            filterlist.splice(position, 1);

            document.querySelector('#filtercount').innerHTML = filterlist.length
            document.querySelector('#filterlist').value = filterlist
            console.log(filterlist, document.querySelector('#filterlist').value)
        }
    }

}

document.querySelector('#bedmin').value = '{{firstbedmin|safe}}'
document.querySelector('#bedmax').value = '{{firstbedmax|safe}}'
document.querySelector('#pricemax').value = '{{firstpricemax|safe}}'
document.querySelector('#pricemin').value = '{{firstpricemin|safe}}'
var firstpropertytype = '{{firstpropertytype|safe}}'
firstpropertytype = firstpropertytype.split(',')
console.log(firstpropertytype)
for(i=0; i<firstpropertytype.length; i++){
    if (firstpropertytype[i] == 'All property types'){
        document.querySelector('#All').checked = true
        document.querySelector('#House').checked = true
        document.querySelector('#Apartment').checked = true
        document.querySelector('#Town').checked = true
        document.querySelector('#Villa').checked = true
        document.querySelector('#Land').checked = true
        document.querySelector('#Acreage').checked = true
        document.querySelector('#Rural').checked = true
        document.querySelector('#Block').checked = true
         document.querySelector('#Retirement').checked = true

    }
    else{
    if (firstpropertytype[i] == 'House'){

        document.querySelector('#House').checked = true
    }
    if (firstpropertytype[i] == 'Apartment & Unit'){

        document.querySelector('#Apartment').checked = true
    }
    if (firstpropertytype[i] == 'Town House'){

        document.querySelector('#Town').checked = true
    }
    if (firstpropertytype[i] == 'Villa'){

        document.querySelector('#Villa').checked = true
    }
    if (firstpropertytype[i] == 'Land'){

        document.querySelector('#Land').checked = true
    }
    if (firstpropertytype[i] == 'Acreage'){

        document.querySelector('#Acreage').checked = true
    }
    if (firstpropertytype[i] == 'Rural'){

        document.querySelector('#Rural').checked = true
    }
    if (firstpropertytype[i] == 'Block Of Units'){

        document.querySelector('#Block').checked = true
    }
    if (firstpropertytype[i] == 'Retirement Living"'){

        document.querySelector('#Retirement').checked = true
    }


    }
    //else

}

// changePropertyType(e)


mysearch = {{mylist|safe}}
document.querySelector("#hiddensearch").value = mysearch
console.log(document.querySelector("#hiddensearch").value)
for (i=0;i<mysearch.length;i++){
    qs = mysearch[i]
    searchlist.push(qs)
    var element = document.createTextNode(qs+ ' X')
    // console.log(mysearch[i], 'listttt', element)

var searchitem = document.querySelector("#searchitem")
var spanelement = document.createElement("span");
var length = searchlist.length
spanelement.setAttribute("class", "badge badge-primary badge-lg");
spanelement.setAttribute("id", 'itemid'+length);
spanelement.style.marginLeft = '3px';
spanelement.style.marginRight = '3px';

spanelement.addEventListener('click',
function(){
var id = this.innerHTML.slice(0,-2)
var index = searchlist.indexOf(id)
searchlist.splice( index, 1 );
// console.log(id, index, searchlist)
this.remove()
var hiddensearch= document.querySelector("#hiddensearch").value = searchlist
console.log(searchlist)
// var checkboxes = document.querySelectorAll('input[type=checkbox][name=propertycheck]:checked')

// for (var i = 0; i < checkboxes.length; i++) {
// propertyarray.push(checkboxes[i].value)
// }
//var propertytype1 = document.querySelector("#propertytype1").value = propertylist

//console.log(propertytype1)
}
)



spanelement.appendChild(element)

searchitem.appendChild(spanelement)


}


propertylist=[]
function changePropertyType(e){
<!--console.log(e)-->
var id = '#'+e
var qs =document.querySelector(id)
var a = propertylist.indexOf(qs.value);

if (qs.checked==false){
    if(qs.value=='All property types'){
        document.querySelector('#House').checked = false

        document.querySelector('#Apartment').checked = false

        document.querySelector('#Town').checked = false

        document.querySelector('#Villa').checked = false

        document.querySelector('#Land').checked = false

        document.querySelector('#Acreage').checked = false

        document.querySelector('#Rural').checked = false

        document.querySelector('#Retirement').checked = false

        document.querySelector('#Block').checked = false
        propertylist = []
        console.log(propertylist)


    }}

if (qs.checked==true){
    if(qs.value=='All property types'){
        document.querySelector('#House').checked = true
        propertylist.push(document.querySelector('#House').value)
        document.querySelector('#Apartment').checked = true
        propertylist.push(document.querySelector('#Apartment').value)
        document.querySelector('#Town').checked = true
        propertylist.push(document.querySelector('#Town').value)
        document.querySelector('#Villa').checked = true
        propertylist.push(document.querySelector('#Villa').value)
        document.querySelector('#Land').checked = true
        propertylist.push(document.querySelector('#Land').value)
        document.querySelector('#Acreage').checked = true
        propertylist.push(document.querySelector('#Acreage').value)
        document.querySelector('#Rural').checked = true
        propertylist.push(document.querySelector('#Rural').value)
        document.querySelector('#Retirement').checked = true
        propertylist.push(document.querySelector('#Retirement').value)
        document.querySelector('#Block').checked = true
        propertylist.push(document.querySelector('#Block').value)
         }


if (a==-1){

propertylist.push(qs.value)
var propertytype1 = document.querySelector('#propertytype1')
propertytype1.value = propertylist
console.log(propertytype1.value)
} //if a==-1


else{

propertylist.splice(a, 1);
var propertytype1 = document.querySelector('#propertytype1')
propertytype1.value= propertylist
console.log(propertytype1.value)

}//else
}// if qs


else{
    // console.log('nahhhh')
    propertylist.splice(a, 1);
    var propertytype1 = document.querySelector('#propertytype1')
    propertytype1.value= propertylist
    console.log(propertytype1.value)
}

} //function







function autocomplete(inp, arr) {
  /*the autocomplete function takes two arguments,
  the text field element and an array of possible autocompleted values:*/
  var currentFocus;
  /*execute a function when someone writes in the text field:*/
  inp.addEventListener("input", function(e) {
      var a, b, i, val = this.value;
      /*close any already open lists of autocompleted values*/
      closeAllLists();
      if (!val) { return false;}
      currentFocus = -1;
      /*create a DIV element that will contain the items (values):*/
      a = document.createElement("DIV");
      a.setAttribute("id", this.id + "autocomplete-list");
      a.setAttribute("class", "autocomplete-items");
      /*append the DIV element as a child of the autocomplete container:*/
      this.parentNode.appendChild(a);
      /*for each item in the array...*/
      for (i = 0; i < arr.length; i++) {
        /*check if the item starts with the same letters as the text field value:*/
        if (arr[i].substr(0, val.length).toUpperCase() == val.toUpperCase()) {
          /*create a DIV element for each matching element:*/
          b = document.createElement("DIV");
          /*make the matching letters bold:*/
          b.innerHTML = "<strong>" + arr[i].substr(0, val.length) + "</strong>";
          b.innerHTML += arr[i].substr(val.length);
          /*insert a input field that will hold the current array item's value:*/
          b.innerHTML += "<input type='hidden' value='" + arr[i] + "'>";
          /*execute a function when someone clicks on the item value (DIV element):*/
          b.addEventListener("click", function(e) {
              /*insert the value for the autocomplete text field:*/
              inp.value = this.getElementsByTagName("input")[0].value;
              /*close the list of autocompleted values,
              (or any other open lists of autocompleted values:*/
              closeAllLists();
          });
          a.appendChild(b);
        }
      }
  });
  /*execute a function presses a key on the keyboard:*/
  inp.addEventListener("keydown", function(e) {
      var x = document.getElementById(this.id + "autocomplete-list");
      if (x) x = x.getElementsByTagName("div");
      if (e.keyCode == 40) {
        /*If the arrow DOWN key is pressed,
        increase the currentFocus variable:*/
        currentFocus++;
        /*and and make the current item more visible:*/
        addActive(x);
      } else if (e.keyCode == 38) { //up
        /*If the arrow UP key is pressed,
        decrease the currentFocus variable:*/
        currentFocus--;
        /*and and make the current item more visible:*/
        addActive(x);
      } else if (e.keyCode == 13) {
        /*If the ENTER key is pressed, prevent the form from being submitted,*/
        e.preventDefault();
        if (currentFocus > -1) {
          /*and simulate a click on the "active" item:*/
          if (x) x[currentFocus].click();
        }
      }
  });
  function addActive(x) {
    /*a function to classify an item as "active":*/
    if (!x) return false;
    /*start by removing the "active" class on all items:*/
    removeActive(x);
    if (currentFocus >= x.length) currentFocus = 0;
    if (currentFocus < 0) currentFocus = (x.length - 1);
    /*add class "autocomplete-active":*/
    x[currentFocus].classList.add("autocomplete-active");
  }
  function removeActive(x) {
    /*a function to remove the "active" class from all autocomplete items:*/
    for (var i = 0; i < x.length; i++) {
      x[i].classList.remove("autocomplete-active");
    }
  }
  function closeAllLists(elmnt) {
    /*close all autocomplete lists in the document,
    except the one passed as an argument:*/
    var x = document.getElementsByClassName("autocomplete-items");
    for (var i = 0; i < x.length; i++) {
      if (elmnt != x[i] && elmnt != inp) {
        x[i].parentNode.removeChild(x[i]);
      }
    }
  }
  /*execute a function when someone clicks in the document:*/
  document.addEventListener("click", function (e) {
    document.querySelector("#searchitem").style.display = 'block'
    var inputedvalue = document.querySelector("#myInput").value
    if (inputedvalue){
    var searchitem = document.querySelector("#searchitem")
    var inputedvalue = document.querySelector("#myInput").value
    var spanelement = document.createElement("span");
    var length = searchlist.length
    spanelement.setAttribute("class", "badge badge-primary badge-lg");
    spanelement.setAttribute("id", 'itemid'+length);
    spanelement.style.marginLeft = '3px';
    spanelement.style.marginRight = '3px';

    spanelement.addEventListener('click',
    function(){
    var id = this.innerHTML.slice(0,-2)
    var index = searchlist.indexOf(id)
    searchlist.splice( index, 1 );
    // console.log(id, index, searchlist)
    this.remove()
    var hiddensearch= document.querySelector("#hiddensearch").value = searchlist

    // var checkboxes = document.querySelectorAll('input[type=checkbox][name=propertycheck]:checked')

    // for (var i = 0; i < checkboxes.length; i++) {
    // propertyarray.push(checkboxes[i].value)
    // }
    //var propertytype1 = document.querySelector("#propertytype1").value = propertylist

    //console.log(propertytype1)
    }

    )

    var testnode = document.createTextNode(inputedvalue)
    var cancel = document.createTextNode(' X')


    spanelement.appendChild(testnode)
    spanelement.appendChild(cancel)


    // console.log(spanelement)

    searchitem.appendChild(spanelement)
    searchlist[length] = spanelement.innerHTML
    var hiddensearch= document.querySelector("#hiddensearch").value = searchlist


    // var checkboxes = document.querySelectorAll('input[type=checkbox][name=propertycheck]:checked')

    // for (var i = 0; i < checkboxes.length; i++) {
    // propertyarray.push(checkboxes[i].value)
    // }
    //var propertytype1 = document.querySelector("#propertytype1").value = propertylist

  console.log(searchlist)

    inputedvalue = document.querySelector("#myInput").value = ''
    // document.querySelector("#myInput").focus()
    }

    // console.log(inputedvalue)
      closeAllLists(e.target);

  });
}

/*An array containing all the country names in the world:*/
// var countries = ["Afghanistan","Albania","Algeria","Andorra","Angola","Anguilla","Antigua & Barbuda","Argentina","Armenia","Aruba","Australia","Austria","Azerbaijan","Bahamas","Bahrain","Bangladesh","Barbados","Belarus","Belgium","Belize","Benin","Bermuda","Bhutan","Bolivia","Bosnia & Herzegovina","Botswana","Brazil","British Virgin Islands","Brunei","Bulgaria","Burkina Faso","Burundi","Cambodia","Cameroon","Canada","Cape Verde","Cayman Islands","Central Arfrican Republic","Chad","Chile","China","Colombia","Congo","Cook Islands","Costa Rica","Cote D Ivoire","Croatia","Cuba","Curacao","Cyprus","Czech Republic","Denmark","Djibouti","Dominica","Dominican Republic","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Ethiopia","Falkland Islands","Faroe Islands","Fiji","Finland","France","French Polynesia","French West Indies","Gabon","Gambia","Georgia","Germany","Ghana","Gibraltar","Greece","Greenland","Grenada","Guam","Guatemala","Guernsey","Guinea","Guinea Bissau","Guyana","Haiti","Honduras","Hong Kong","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Isle of Man","Israel","Italy","Jamaica","Japan","Jersey","Jordan","Kazakhstan","Kenya","Kiribati","Kosovo","Kuwait","Kyrgyzstan","Laos","Latvia","Lebanon","Lesotho","Liberia","Libya","Liechtenstein","Lithuania","Luxembourg","Macau","Macedonia","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Marshall Islands","Mauritania","Mauritius","Mexico","Micronesia","Moldova","Monaco","Mongolia","Montenegro","Montserrat","Morocco","Mozambique","Myanmar","Namibia","Nauro","Nepal","Netherlands","Netherlands Antilles","New Caledonia","New Zealand","Nicaragua","Niger","Nigeria","North Korea","Norway","Oman","Pakistan","Palau","Palestine","Panama","Papua New Guinea","Paraguay","Peru","Philippines","Poland","Portugal","Puerto Rico","Qatar","Reunion","Romania","Russia","Rwanda","Saint Pierre & Miquelon","Samoa","San Marino","Sao Tome and Principe","Saudi Arabia","Senegal","Serbia","Seychelles","Sierra Leone","Singapore","Slovakia","Slovenia","Solomon Islands","Somalia","South Africa","South Korea","South Sudan","Spain","Sri Lanka","St Kitts & Nevis","St Lucia","St Vincent","Sudan","Suriname","Swaziland","Sweden","Switzerland","Syria","Taiwan","Tajikistan","Tanzania","Thailand","Timor L'Este","Togo","Tonga","Trinidad & Tobago","Tunisia","Turkey","Turkmenistan","Turks & Caicos","Tuvalu","Uganda","Ukraine","United Arab Emirates","United Kingdom","United States of America","Uruguay","Uzbekistan","Vanuatu","Vatican City","Venezuela","Vietnam","Virgin Islands (US)","Yemen","Zambia","Zimbabwe"];





var list2 = []
{% for i in qs %}
list2.push('{{i.suburb}}' + ' - ' +  '{{i.state}}')
{% endfor %}



// this will take the least of items to be searched


function InputChange(){
/*initiate the autocomplete function on the "myInput" element, and pass along the countries array as possible autocomplete values:*/

autocomplete(document.getElementById("myInput"), list2);
  document.querySelector("#searchitem").style.display = 'block';
  var searchitem = document.querySelector("#myInput").value
  if (searchitem.includes(";")){
    console.log("ok")


    var inputedvalue = document.querySelector("#myInput").value


    if (inputedvalue){
    var length = searchlist.length
    var searchitem = document.querySelector("#searchitem")
    inputedvalue = inputedvalue.slice(0, -1);
    var spanelement = document.createElement("span");
    spanelement.setAttribute("class", "badge badge-primary");
    // var addlength =  length
    spanelement.setAttribute("id", 'itemid'+length);



    spanelement.style.marginLeft = '3px';
    spanelement.style.marginRight = '3px';
    spanelement.addEventListener('click',
    function(){
    var id = this.innerHTML.slice(0,-2)

    // var element = document.querySelector(id);


    var index = searchlist.indexOf(id)
    searchlist.splice( index, 1 );
    // var propertyarray = []
    // var checkboxes = document.querySelectorAll('input[type=checkbox][name=propertycheck]:checked')

    // for (var i = 0; i < checkboxes.length; i++) {
    // propertyarray.push(checkboxes[i].value)
    // }
    // var propertytype1 = document.querySelector("#propertytype1").value = propertylist


    this.remove()

    var hiddensearch= document.querySelector("#hiddensearch").value = searchlist
    // console.log(propertyarray)
    })

    var testnode = document.createTextNode(inputedvalue)
    var cancel = document.createTextNode(' X')
    spanelement.appendChild(testnode)
    spanelement.appendChild(cancel)
    searchitem.appendChild(spanelement)
    searchlist[length] = spanelement.innerHTML
    console.log(searchlist)
    var hiddensearch= document.querySelector("#hiddensearch").value = searchlist

    var checkboxes = document.querySelectorAll('input[type=checkbox][name=propertycheck]:checked')

    // for (var i = 0; i < checkboxes.length; i++) {
    // propertyarray.push(checkboxes[i].value)
    // }
    //var propertytype1 = document.querySelector("#propertytype1").value = propertylist
    // var bedmin1 = document.querySelector("#bedmin1").value = document.querySelector(".bedmin").innerHTML.trim().slice(0, 1);
    // var bedmax1 = document.querySelector("#bedmax1").value = document.querySelector(".bedmax").innerHTML.trim().slice(0, 1);
    // var pricemin1 = document.querySelector("#pricemin1").value = document.querySelector(".pricemin").innerHTML
    // var pricemax1 = document.querySelector("#pricemax1").value = document.querySelector(".pricemax").innerHTML
    // console.log(bedmin1)
    inputedvalue = document.querySelector("#myInput").value = ''
    }


  }

}
// endof inputchange function



function filterState(e){
document.querySelector('.modal-title').innerHTML = 'Search bu suburb, postcode'

document.getElementById("loading").style.display = 'block'


document.getElementById("myInput").style.display = 'none';

document.getElementById("loading").innerHTML = 'loading'



test(e)
}
// end of function


function test(e){
        list1=[]

    for(i=0; i<list2.length; i++){

    if(list2[i].includes(e)){
    list1.push(list2[i])
    console.log('yeahh')
    }


    else{
        console.log('nahhh')
    }
    console.log(document.getElementById("loader").style.display, 'okay')

}
// end for loop


autocomplete(document.getElementById("myInput"), list1);
document.getElementById("loading").innerHTML = 'done'
document.getElementById("myInput").style.display = 'block';
console.log(e, 'done')
/*initiate the autocomplete function on the "myInput" element, and pass along the countries array as possible autocomplete values:*/
}





</script>

<!-- slider script -->
<script>
// var slider = document.getElementById("myRange");
// var output = document.getElementById("demoslide");
// output.innerHTML = slider.value;

// slider.oninput = function() {
//   output.innerHTML = this.value;
// }

// var maxslider = document.getElementById("myRange2");
// var maxoutput = document.getElementById("demoslide2");
// maxoutput.innerHTML = maxslider.value;

// maxslider.oninput = function() {
//   maxoutput.innerHTML = this.value;
// }





var url1 = 'http://anandrathi.pythonanywhere.com/'
function StarSearch(e){
console.log(e)
var token = document.querySelector("input[name=csrfmiddlewaretoken]").value

var url = url1 +'savesearch/'
let  formData = new FormData()
formData.append('post_id', e)


fetch(url,
{
body: new URLSearchParams(formData),
method: 'post',
headers:{
'X-CSRFTOKEN': token
}


}).then(res => res.json()).then(function(data) {
var post_id = '#star'+data.post_id
if (data.msg == 'saved'){
document.querySelector(post_id).style.color = 'orange'
}
else if (data.msg == 'deleted'){
document.querySelector(post_id).style.color = 'grey'
}
console.log(data)



})

}



function mapShow(){
    document.querySelector('#map').style.display='block'
    document.querySelector('#profile').style.display='none'

    console.log('shown')
}

function mapHide(){
    document.querySelector('#map').style.display='none'
    document.querySelector('#profile').style.display='block'

    console.log('hidden')
}




// console.log('datatttttttt iss', latitude, longitude, address);
function initMap() {
    // console.log('datatttttttt iss', latitude, longitude);

	var broadway = {
		info: '<strong>Chipotle on Broadway</strong><br>\
					 N Broadway St<br> Chicago, IL 60640<br>\
					<a href="https://goo.gl/maps/jKNEDz4SyyH2">Get Directions</a>',
		lat: 41.976816,
		long: -87.659916
	};




	var sheridan = {
		info: '<strong>Chipotle on Sheridan</strong><br>\r\
					6600 N Sheridan Rd<br> Chicago, IL 60626<br>\
					<a href="https://goo.gl/maps/QGUrqZPsYp92">Get Directions</a>',
		lat: 42.002707,
		long: -87.661236
	};

	var locations = [
      [broadway.info, broadway.lat, broadway.long],
      [sheridan.info, sheridan.lat, sheridan.long],
      ['sheridan.info', -31.9431656, 115.876085],
      ['sheridan.info2222', -31.94942, 115.831923],

    ];

    // var locations = [
    // {% for i in pagin %}

    //   ['{{i.street_number}}' + ', ' + '{{i.street_name}}' + ', '  + '{{i.suburb}}' + ', '  + '{{i.state}}' + ', '  + '{{i.postcode}}', {{i.longitude}} , {{i.latitude}}],
    // {% endfor %}

    //  ];

    console.log(locations)

	var map = new google.maps.Map(document.getElementById('map'), {
		zoom: 13,
		center: new google.maps.LatLng(-35.473469, 149.012375),
		mapTypeId: google.maps.MapTypeId.ROADMAP
	});

	var infowindow = new google.maps.InfoWindow({});

	var marker, i;

	for (i = 0; i < locations.length; i++) {
		marker = new google.maps.Marker({
			position: new google.maps.LatLng(locations[i][1], locations[i][2]),
			map: map
		});

		google.maps.event.addListener(marker, 'click', (function (marker, i) {
			return function () {
				infowindow.setContent(locations[i][0]);
				infowindow.open(map, marker);
			}
		})(marker, i));
	}
}



</script>


<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBfZ86mdGX5E7o4PGSB7ct22axSb_JzVTY&callback=initMap"></script>


{% endblock %}